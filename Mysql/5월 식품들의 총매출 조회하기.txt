
SELECT T.PRODUCT_ID, T.PRODUCT_NAME, SUM(T.TOTAL_SALES) AS TOTAL_SALES
FROM(
SELECT P.PRODUCT_ID, P.PRODUCT_NAME, P.PRICE * O.AMOUNT AS TOTAL_SALES 
FROM FOOD_PRODUCT P INNER JOIN FOOD_ORDER O
ON P.PRODUCT_ID = O.PRODUCT_ID
WHERE YEAR(O.PRODUCE_DATE) = 2022 AND MONTH(O.PRODUCE_DATE) = 5 ) T
GROUP BY T.PRODUCT_ID
ORDER BY TOTAL_SALES DESC, PRODUCT_ID